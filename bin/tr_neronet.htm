<HTML>
<HEAD>
<TITLE>Обучение нейросети</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<LINK rel="stylesheet" href="css\style.css" type="text/css">
<SCRIPT src="script/buttonscript.js" language="JavaScript"></SCRIPT>
</HEAD>
<BODY>
<A name="begin"></A>
<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
<TR>
	<TD colspan="2">
	<!--часть шапка н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
	<TR>
		<TD rowspan="2" bgcolor="#3B3B3B">
        	<P class="mainhead">
<!--Основной заголовок н-->
Программирование и внедрение нейросетей
<!--Основной заголовок к-->
			</P>
		</TD>
		<TD bgcolor="#3B3B3B" align="right" valign="top">
		<P class="t2">
<!--в шапке справа вверху н-->
<A href="search.htm" class="help"><IMG src="image/search_b.gif" width="16" height="16" border="0"> Поиск&nbsp;&nbsp;</A>
<A href="help.htm" class="help"><IMG src="image/question_b.gif" width="16" height="16" border="0"> Справка&nbsp;&nbsp;</A>

<!--в шапке справа вверху к-->
		</P>
		</TD>
	</TR>
	<TR>
		<TD bgcolor="#3B3B3B">
			<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
			<TR>
				<TD width="166" height="38"><IMG src="image/1.gif" width="166" height="38" border="0"></TD>
				<TD width="100%" height="38" background="image/2.gif"><IMG src="image/2.gif" width="1" height="38" border="0"></TD>
				<TD width="157" height="38"><IMG src="image/3.gif" width="157" height="38" border="0"></TD>
				<TD bgcolor="#6A6A6A">
					<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
					<TR>
						<TD width="100%" height="100%">
<!--в шапке маленькая надпись с права внизу н-->
<P class="t1">РГППУ</P>
<!--в шапке маленькая надпись с права внизу к-->
						<TD>
					</TR>
					<TR><TD width="100%" height="1" bgcolor="#3B3B3B"><IMG src="image/r1.gif" width="1" height="1" border="0"><TD></TR>
					</TABLE>
				</TD>
			</TR>
			</TABLE>
		</TD>
	</TR>
	<TR>
		<TD colspan="2" bgcolor="#626262"><IMG src="image/r2.gif" width="1" height="16" border="0"></TD>
	<TR>
	</TABLE>
	<!--часть шапка к-->
	</TD>
</TR>
<TR>
	<TD width="*" height="100%" bgcolor="#DFEDF6">
	<!--часть навигация н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">

	<TR>
		<TD width="181" height="30"><IMG src="image/r3.gif" width="1" height="30" border="0"></TD>
		<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
	</TR>
<!--кнопки н-->
<!--
<TR>
	<TD width="181" height="30" background="image\b.gif" align="right" valign="middle">
	<P class="button_on"><NOBR>Начало</NOBR></P>
	</TD>
	<TD width="1" height="30" bgcolor="#FFFFFF"><IMG src="image/r5.gif" width="1" height="1" border="0"></TD>
</TR>
-->

<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="start.htm"><NOBR>Начало</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="create_proj.htm"><NOBR>Создание окна</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" background="image\b.gif" align="right" valign="middle">
	<P class="button_on"><NOBR>Создание нейросети</NOBR></P>
	</TD>
	<TD width="1" height="30" bgcolor="#FFFFFF"><IMG src="image/r5.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="initd3d.htm"><NOBR>Запуск Direct3D</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="crdelmod.htm"><NOBR>Визуализация</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="anim.htm">Анимация</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="kamera.htm">Камера</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="bma.htm">ВМА-файл</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="frommaxtox.htm">Экспорт модели</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="impl_neronet.htm">Внедрение нейросети</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle">
	<P class="button_on">&nbsp;</P>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="use_books.htm">Литература</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="ip.htm">Интерфейс пособия</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="metodukaz.htm">Методические указания</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="search.htm">Поиск по пособию</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>

<!--кнопки к-->
	<TR>
		<TD width="181" height="100%"><IMG src="image/r3.gif" width="1" height="1" border="0"></TD>
		<TD width="1" height="100%"  bgcolor="#DFEDF6" valign="top"><IMG src="image/9.gif" width="1" height="161" border="0"></TD>
	</TR>
	<TR>
		<TD width="182" height="1"><IMG src="image/r3.gif" width="182" height="1" border="0"></TD>
	</TR>
	</TABLE>
	<!--часть навигация к-->
	</TD>
	<TD width="100%" height="100%">
	<!--часть содержания н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
	<TR>
		<TD align="justify" valign="top">
<!--содержание н-->


<TABLE cellspacing="5" cellpadding="0" border="0" width="*" height="*" align="center" style="margin-top:10px;">
	<TR>
		<TD><A href="cr_neronet.htm" class="wt">Создание объекта нейросети</A></TD>
		<TD><A href="tr_neronet.htm" class="wt">Обучение нейросети</A></TD>
		<TD><A href="te_neronet.htm" class="wt">Тестирование нейросети</A></TD>	
	</TR>
</TABLE>



<DIV class="layer_window">
<TABLE cellspacing="0" cellpadding="0" border="0" width="*" height="*" align="center" >
<TR>
	<TD width="5" height="23"><IMG src="image/5.gif" width="5" height="23" border="0"></TD>
	<TD width="*" height="23" background="image/4.gif">
		<TABLE cellspacing="0" cellpadding="0" border="0" width="*" height="*" align="center" >
		<TR>
			<TD width="100%" height="23" align="justify" valign="middle" >
<P class="head_window">Создание нейросети</P>
			</TD>
			<TD width="63" height="23"><IMG src="image/mini_b.gif" width="63" height="23" border="0"></TD>
		</TR>
		</TABLE>
	</TD>
	<TD width="5" height="23"><IMG src="image/6.gif" width="5" height="23" border="0"></TD>
<TR>
<TR>
	<TD width="5" height="44" valign="bottom"><IMG src="image/7.gif" width="5" height="44" border="0"></TD>
	<TD height="100%" align="justify" valign="top">
<!--текст окошка н-->

<P class="title2">2. Обучение нейросети</P>
<P class="text">
В первой части данной лабораторной работы вы создали нейросеть. Анализ лог файла, содержащего информацию о сети, 
показал, что сеть «пуста», т.е. значения всех активаций (U), весов (W) и т.п. равны нулю.
Для того чтобы сеть начала функционировать ее нужно прежде обучить. Для этого мы воспользуемся 
алгоритмом обратного распространения.
<P class="text">
Алгоритм обратного распространения – это самый популярный алгоритм для обучения с помощью изменения 
весов связей. Как ясно из названия, ошибка распространяется от выходного слоя к входному, т.е. в 
направлении, противоположном направлению прохождения сигнала при нормальном функционировании сети. 
Хотя алгоритм достаточно простой, его расчет может занять довольно много времени в зависимости от величины ошибки.
<P class="text">
Выполнение алгоритма начинается с создания произвольно сгенерированных весов для многослойной сети. 
Затем, процесс описанный ниже, повторяется до тех пор, пока средняя ошибка на выходе не будет признана достаточно малой:
<BR>1)	Берется пример входного сигнала с соответствующим правильным значением выхода. 
<BR>2)	Рассчитывается прямое распространение (ответ) через сеть.
<BR>3)	Начиная с выходов, выполняется обратное движение через ячейки выходного и промежуточных 
слоев, при этом программа рассчитывает значения ошибок для выходных и скрытых ячеек.
<BR>4)	Наконец, веса в сети обновляются в соответствии со специальными формулами.
<P class="text">
Продвижение вперед по сети рассчитывает активации ячеек и выход, продвижение назад – градиент 
(по отношению к данному примеру). Затем веса обновляются таким образом, чтобы минимизировать ошибку 
для данного выходного сигнала. 
<BR>Коэффициент обучения минимизирует процент изменения, которое может произойти 
с весами. Хотя при небольшом коэффициенте процесс может занят больше времени, но зато мы минимизируем 
возможность пропуска правильной комбинации весов. Если коэффициент обучения слишком велик, сеть может 
никогда не сойтись, т.е. не будут найдены правильные веса связей.

<P class="text2">
<B>Задание 13</B><BR>
Откройте проект, созданный в первой части данной лабораторной работы.

<P class="text2">
<B>Задание 14</B><BR>
Сгенерируйте произвольно все возможные значения нейросети, используя функцию Rand(), единственным
параметром которой является максимально допустимое значение произвольно генерируемых значений. Причем 
минимальное значение равно нулю по умолчанию.<BR>
Для этого запишите ниже приведенный код после создания объекта класса NERO_NET.
<P class="kod">
net->Rand(1.0f);//заполнение сети наугад

<P class="text2">
<B>Задание 15</B><BR>
Так же измените количество обучающих итераций с 1000 на 10000 для того, повысить вероятность 
успешного обучения сети:
<P class="kod">
net->iteration_n = 10000;//количество итераций обучения

<P class="text">
Перейдем непосредственно к обучению.<BR>
Прежде, представьте, что разрабатываемая вами нейросеть принадлежит какому-то компьютерному существу.
У этого существа есть некий показатель его «силы» и он умеет видеть своих врагов.
В соответствии с этими данными разрабатываемая вами сеть должна выбрать адекватное любому 
живому существу действие. К примеру, если силы полные, а врагов нет на горизонте, то просто 
гулять и отдыхать… А если сил нет, но есть враги, то убегать.
Как это сделать? Оказывается очень просто…
<P class="text"> 
В открытом вами проекте создана нейросеть с  двумя входными и тремя выходными неронами. 
Предположим, что первый входной нерон – это силы существа, а второй – количество врагов.
Причем силы будем измерять в цифрах от 0 до 1. Ноль – сил нет, единица - силы полны.
Выходные же нейроны обозначают те высокоуровневые действия, которые нейросеть может выбрать 
в соответствии с силами и количеством врагов: гулять, убегать, атаковать.
<P class="text">
И так, обучающие сигналы будут такими:
<BR>1) Если силы полны, а врага нет, то гулять.
<BR>2) Если сил нет, а враг есть, то убегать.
<BR>3) Если есть силы и враг, то атаковать.

<P class="text">
Как же передать такие параметры сети для обучения? И вообще, как выполнить обучение?
В этом вам поможет функция Training(). Вот ее прототип:
<P class="kod">
void Training(float* incoming_U, float* target_U, unsigned short int n);

<P class="text">
В приведенном выше коде incoming_U - это массив входных значений для неронов, а
target_U - целевых значений выходных неронов, n - количество обучаемых сигналов.<BR>
Указатели incoming_U и target_U ссылаются на одинарные массивы длинной, равной произведению
количества сигналов обучения на количество входных или выходных неронов соответственно.

<P class="text">
К примеру, так будут выглядеть обучающие сигналы, о которых мы говорили:
<P class="kod">
//количество сигналов обучения<BR>
unsigned short int n = 3;<BR><BR>
//значение входных сигналов
<BR>float* inc = new float [n*net->in_kol];
<BR>inc[0]=1.0f; inc[2]=0.0f; inc[4]=1.0f;  
<BR>inc[1]=0.0f; inc[3]=1.0f; inc[5]=1.0f;  
<BR> 
<BR>//значение выходных сигналов
<BR>float* tar = new float [n*net->out_kol];
<BR>tar[0]=1.0f; tar[3]=0.0f; tar[6]=0.0f; 
<BR>tar[1]=0.0f; tar[4]=1.0f; tar[7]=0.0f; 
<BR>tar[2]=0.0f; tar[5]=0.0f; tar[8]=1.0f; 

<P class="text2">
<B>Задание 16</B><BR>
Запишите приведенный выше код сразу после функции Rand(), а затем поговорим о нем подробнее.

<P class="text">
Строка   float* inc = new float [n*net->in_kol];  - это стандартный способ создать массив в 
языке С++ типа float, размерностью n*net->in_kol, где n – количество обучающих сигналов, а 
net->in_kol – количество входных неронов.<BR>
Далее, после этой строчки идет непосредственно задание значений ячеек массива.<BR>
Таким же образом задаются и целевые значения обучения, за исключением того, что вместо 
net->in_kol используется net->out_kol – количество выходных неронов.

<P class="text2">
<B>Задание 17</B><BR>
И последнее, что нужно сделать, это передать созданные массивы в функцию Training(). Для этого
сразу после создания и заполнения массивов incoming_U и target_U запишите следующее:
<P class="kod">
//ОБУЧЕНИЕ НЕЙРОСЕТИ<BR>
net->Training(inc, tar, n);

<P class="text">
На этом обучение нейросети законченно. 

<P class="text2">
<B>Задание 18</B><BR>
Откомпилируйте свой проект и запустите исполняемый файл и проанализируйте лог файл. 

<P class="text2">
<B>Задание 19</B><BR>
Если у вас возникли какие либо проблемы, то вы можете взять готовый проект 
<A href="files\traning_neronet.zip" class="wt">здесь</A>
 и попытаться найти свою ошибку.

<P class="title2">Вопросы для  самоконтроля</P>
<P class="text">
1) Перечислите основные этапы обучения нейросети?
<BR>2) За что отвечает коэффициент обучения?
<BR>3) В чем отличие коэффициента обучения и количества обучающих итераций?
<BR>4) Какой метод класса NERO_NET отвечает за обучение нейросети и какие параметры ему нужно передать?
<BR>5) Почему длинна массивов входных и целевых значений определяется формулой n*net->in_kol?


<P align="center">
<A href="cr_neronet.htm" class="wt">назад</A>
<A href="te_neronet.htm" class="wt">далее</A>
</P>

<!--текст окошка к-->
	<P align="right"><A href="#begin" class="wt">наверх</A></P><BR>
	</TD>
	<TD width="5" height="44" valign="bottom"><IMG src="image/8.gif" width="5" height="44" border="0"></TD>
</TR>
<TR>
	<TD width="5" height="1"><IMG src="image/r5.gif" width="5" height="1" border="0"></TD>
	<TD width="*" height="1" bgcolor="#CFDDF2"><IMG src="image/r6.gif" width="1" height="1" border="0"></TD>
	<TD width="5" height="1"><IMG src="image/r5.gif" width="5" height="1" border="0"></TD>
</TR>
</TABLE>
</DIV>
<P class="mini">MR, Кузнецов Алексей КТ-503, РГППУ, 2007г.</P>
<!--содержание к-->
		</TD>
	</TR>
	</TABLE>
	<!--часть содержания к-->
	</TD>
</TR>
<TR>
</TR>
</TABLE>
</BODY>
</HTML>