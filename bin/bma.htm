<HTML>
<HEAD>
<TITLE>ВМА-файл</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<LINK rel="stylesheet" href="css\style.css" type="text/css">
<SCRIPT src="script/buttonscript.js" language="JavaScript"></SCRIPT>
</HEAD>
<BODY>
<A name="begin"></A>
<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
<TR>
	<TD colspan="2">
	<!--часть шапка н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
	<TR>
		<TD rowspan="2" bgcolor="#3B3B3B">
        	<P class="mainhead">
<!--Основной заголовок н-->
Программирование и внедрение нейросетей
<!--Основной заголовок к-->
			</P>
		</TD>
		<TD bgcolor="#3B3B3B" align="right" valign="top">
		<P class="t2">
<!--в шапке справа вверху н-->
<A href="search.htm" class="help"><IMG src="image/search_b.gif" width="16" height="16" border="0"> Поиск&nbsp;&nbsp;</A>
<A href="help.htm" class="help"><IMG src="image/question_b.gif" width="16" height="16" border="0"> Справка&nbsp;&nbsp;</A>

<!--в шапке справа вверху к-->
		</P>
		</TD>
	</TR>
	<TR>
		<TD bgcolor="#3B3B3B">
			<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
			<TR>
				<TD width="166" height="38"><IMG src="image/1.gif" width="166" height="38" border="0"></TD>
				<TD width="100%" height="38" background="image/2.gif"><IMG src="image/2.gif" width="1" height="38" border="0"></TD>
				<TD width="157" height="38"><IMG src="image/3.gif" width="157" height="38" border="0"></TD>
				<TD bgcolor="#6A6A6A">
					<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
					<TR>
						<TD width="100%" height="100%">
<!--в шапке маленькая надпись с права внизу н-->
<P class="t1">РГППУ</P>
<!--в шапке маленькая надпись с права внизу к-->
						<TD>
					</TR>
					<TR><TD width="100%" height="1" bgcolor="#3B3B3B"><IMG src="image/r1.gif" width="1" height="1" border="0"><TD></TR>
					</TABLE>
				</TD>
			</TR>
			</TABLE>
		</TD>
	</TR>
	<TR>
		<TD colspan="2" bgcolor="#626262"><IMG src="image/r2.gif" width="1" height="16" border="0"></TD>
	<TR>
	</TABLE>
	<!--часть шапка к-->
	</TD>
</TR>
<TR>
	<TD width="*" height="100%" bgcolor="#DFEDF6">
	<!--часть навигация н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">

	<TR>
		<TD width="181" height="30"><IMG src="image/r3.gif" width="1" height="30" border="0"></TD>
		<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
	</TR>
<!--кнопки н-->
<!--
<TR>
	<TD width="181" height="30" background="image\b.gif" align="right" valign="middle">
	<P class="button_on"><NOBR>Начало</NOBR></P>
	</TD>
	<TD width="1" height="30" bgcolor="#FFFFFF"><IMG src="image/r5.gif" width="1" height="1" border="0"></TD>
</TR>
-->

<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="start.htm"><NOBR>Начало</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="create_proj.htm"><NOBR>Создание окна</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="cr_neronet.htm"><NOBR>Создание нейросети</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="initd3d.htm"><NOBR>Запуск Direct3D</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="crdelmod.htm"><NOBR>Визуализация</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="anim.htm">Анимация</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="kamera.htm">Камера</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" background="image\b.gif" align="right" valign="middle">
	<P class="button_on"><NOBR>ВМА-файл</NOBR></P>
	</TD>
	<TD width="1" height="30" bgcolor="#FFFFFF"><IMG src="image/r5.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="frommaxtox.htm">Экспорт модели</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="impl_neronet.htm">Внедрение нейросети</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle">
	<P class="button_on">&nbsp;</P>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="use_books.htm">Литература</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="ip.htm">Интерфейс пособия</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="metodukaz.htm">Методические указания</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="search.htm">Поиск по пособию</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>

<!--кнопки к-->
	<TR>
		<TD width="181" height="100%"><IMG src="image/r3.gif" width="1" height="1" border="0"></TD>
		<TD width="1" height="100%"  bgcolor="#DFEDF6" valign="top"><IMG src="image/9.gif" width="1" height="161" border="0"></TD>
	</TR>
	<TR>
		<TD width="182" height="1"><IMG src="image/r3.gif" width="182" height="1" border="0"></TD>
	</TR>
	</TABLE>
	<!--часть навигация к-->
	</TD>
	<TD width="100%" height="100%">
	<!--часть содержания н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
	<TR>
		<TD align="justify" valign="top">
<!--содержание н-->


<TABLE cellspacing="5" cellpadding="0" border="0" width="*" height="*" align="center" style="margin-top:10px;">
	<TR>
		<TD><A href="#1" class="wt">Структура ВМА</A></TD>
		<TD><A href="#2" class="wt">Интерфейс ХТоВМА</A></TD>
		<TD><A href="#3" class="wt">Технология создания ВМА</A></TD>	
	</TR>
</TABLE>



<DIV class="layer_window">
<TABLE cellspacing="0" cellpadding="0" border="0" width="*" height="*" align="center" >
<TR>
	<TD width="5" height="23"><IMG src="image/5.gif" width="5" height="23" border="0"></TD>
	<TD width="*" height="23" background="image/4.gif">
		<TABLE cellspacing="0" cellpadding="0" border="0" width="*" height="*" align="center" >
		<TR>
			<TD width="100%" height="23" align="justify" valign="middle" >
<P class="head_window">ВМА-файл</P>
			</TD>
			<TD width="63" height="23"><IMG src="image/mini_b.gif" width="63" height="23" border="0"></TD>
		</TR>
		</TABLE>
	</TD>
	<TD width="5" height="23"><IMG src="image/6.gif" width="5" height="23" border="0"></TD>
<TR>
<TR>
	<TD width="5" height="44" valign="bottom"><IMG src="image/7.gif" width="5" height="44" border="0"></TD>
	<TD height="100%" align="justify" valign="top">
<!--текст окошка н-->



<P class="title">Лабораторная работа №7</P>
<P class="title3">СОЗДАНИЕ BMA-ФАЙЛА</P> 
<P class="title2">В этой лабораторной работе вы научитесь:</P>
<P class="text">
1.	Основам создания бинарных файлов.
<BR>2.	Способу создания BMA-файлов.
<BR>3.	Работе с программой XToBMA.


<P class="text">
BMA-файл (Binary Morphed Animation file) – бинарный файл, содержащий морфируемую модель.

<P class="title2"><A name="1">1. Структура BMA-файла</A></P>
<P class="text">
1) Количество вершин в модели (2 байта).
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Этот параметр один для всех мешей содержащихся в файле (это вытекает из правил морфинга, о 
которых рассказывалось в главе «Анимация»).
<BR>2) Текстурный путь (256 байт).
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Содержит путь к текстуре.
<BR>3) Количество анимаций (2 байта).
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Поле, содержащее количество анимаций в файле.
<BR>4) Количество последовательностей (кол. аним * 2 байта)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Тут идет набор полей, содержащих количество последовательностей в каждой анимации. 
Всего полей ровно столько сколько анимаций.
<BR>5) Раздел данных.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Раздел данных – это набор информаций о мешах. Меши перечисляются последовательно: 
первый меш первой анимации, затем второй меш первой анимации и т.д. Вершины в меше так же 
перечисляются последовательно, причем информация о вершине состоит из восьми цифр (в порядке 
следования): x, y, z, nx, ny, nz, tu, tv. Где  x, y, z – пространственные координаты вершины, 
nx, ny, nz – её нормаль, tu, tv – текстурные координаты.

<P class="text">
Ниже приведен рисунок  (Рис. 1) показывающий последовательность расположения информации в ВМА-файле:

<CENTER><IMG src="image\examp\9.jpg" border="0" alt="BMA-файл" class="bo"></CENTER>
<CENTER><P class="ris">Рис. 1</P></CENTER>
<P class="text">
Для того, чтобы создавать такие файлы воспользуйтесь специально подготовленной утилиткой XToBMA.exe, которую можно скачать 
<A href="files\xtobma.zip" class="wt">здесь</A>
.<BR><BR>

<P class="title2"><A name="2">2. Интерфейсе программы XToBMA</A></P>
<CENTER><IMG src="image\examp\10.jpg" border="0" alt="" class="bo"></CENTER>
<CENTER><P class="ris">Рис. 2</P></CENTER>
<P class="text">
В самом верху окна программы (Рис. 2), находиться главная панель. Слева блок Object Information, который предназначен 
для отображения информации об открытом X-файле. Чуть ниже поле X file information, в котором после открытия 
X-файла можно просмотреть считанные данные, нажав кнопку Show.<BR>
Справа расположены поля, предназначенные для формирования BMA-файла. Если присмотреться, то они в точности 
напоминают его структуру (Рис. 1).

<P class="text">
Кнопка "kol_v >" считает количество вершин в модели из открытого Х-файла и запишет в поле Quantity of vertex. 
Такое действие нужно делать один раз при создание файла, т.к. количество вершин во всех последовательностях 
должно быть одинаковое!<BR>
Далее поля Texture pass и Quantity of animations заполняются вручную, посредствам ввода цифр.<BR>
Поле Continuity заполняется через другое поле ввода, располагающегося слева (Рис. 3). 
Кнопка "Add >" переносит данные в поле Continuity.
<CENTER><IMG src="image\examp\11.jpg" border="0" alt="" class="bo"></CENTER>
<CENTER><P class="ris">Рис. 3</P></CENTER>

<P class="text">
Кнопка "Clear >" очищает поле Continuity.

<P class="text">
Далее идет раздел данных. В поле Massiv of data при нажатии кнопки "add_v >" будут записываться 
вершины, считанные из Х-файла.

<P class="title2"><A name="3">3. Технология создания ВМА-файла</A></P>
<P class="text">
В технологии создания ВМА-файлов особых секретов и сложностей нет: 
<BR>1) Вы получаете *.x файлы из любого трехмерного редактора (3Ds MAX и т.п.).
Каждый Х-файл содержит информацию о сцене. Информация о сцене представляет из себя набор мешей.
<BR>2) Вторым шагом выделяете нужный вам меш в каждом Х-файле.
<BR>3) Потом, постепенно, открывая каждый из Х-файлов в программе ХТоВМА через меню File > Open (от первого к последнему), жмете кнопку «add_v >», 
чтобы добавить информацию о меше в раздел данных ВМА-файла.
<BR>4) Когда вы откроете первый Х-файл, не забудьте заполнить все другие обязательные поля, о 
которых писалось выше.
<BR>5) После того, как вы создали ВМА-файл, не забудьте его  сохранить через меню File > Save As. 
Перед вами откроется диалог сохранения, в котором вы должны вписать имя файла и расширение "bma".
</P>

<P class="title2">4. Использование программы XToBMA</P> 
<P class="text">
После теории попробйте сделать один ВМА-файл самостоятельно!
Для вас подготовлен набор X-файлов, которые можно скачать 
<A href="files\run.zip" class="wt">здесь</A>
.<BR>
-----------------------<BR> 
<FONT color="red">
Обратите внимание, что при создании ВМА-файла перед загрузкой Х-файлов в 
программу ХТоВМА нужно указать, какой мешь (в Х файле может быть их много) вы будете транспортировать. 
Для этого вы в Х-файле находите строчку подобную: " Mesh m_widge { " и обрамляете слово "Mesh" в ">>Mesh<<".<BR>
В этой строчке слово "Mesh" означает, что далее пойдет информация о меше с именем "m_widge".
</FONT>
<BR>-----------------------<BR> 
В результате такого подхода у вас появляется возможность 
транспортировать в ВМА-файл любой объект трехмерной сцены, хранящейся в Х-файле!

<P class="text2">
<B>Задание 1</B><BR>
Скачайте 
<A href="files\run.zip" class="wt">архив</A> 
с Х-файлами в свою рабочую папку и разархивируйте его. 

<P class="text2">
<B>Задание 2</B><BR>
Начиная с первого файла архива открывайте все последовательно и изменяйте инструкцию "Mesh m_widge {" таким образом: ">>Mesh<< m_widge {" .

<P class="text2">
<B>Задание 3</B><BR>
Запустите программу XToBMA если она у вас все еще не запущена.

<P class="text2">
<B>Задание 4</B><BR>
- Откройте с помошью программы ХТоВМА файл 1.Х. 
<BR>- В поле Quantity of vertex занесите количество вершин, нажав на кнопку
"kol_v >". 
<BR>- Далее в поле Texture pass напишите "pauk.jpg". Данную текстуру можно взять 
<A href="files\pauk.jpg" class="wt">здесь</A>
. 
<BR>- В поле Quantity of animations занесите цифру 1, т.к. у вас всего одна анимация. 
<BR>- Далее в поле Continuity занесите 4, т.к.
вы имеете 4 последовательностей. И последнее... 
<BR>- В поле Massiv of data занесите информацию о вершинах, нажав на 
кнопку "add_v >".

<P class="text2">
<B>Задание 5</B><BR>
Откройте следующий Х-файл (2.Х) и нажмите "add_v >". И так далее оставшихся 2 Х-файла.

<P class="text2">
<B>Задание 6</B><BR> 
Сохраните результат (File > Save As). Впишите, в открывшемся "Сэйвдиалоге", имя будущего ВМА-файла: 
pauk_run.bma .

<P class="text">
Естественно, теперь нужно подключить этот файл к проекту и посмотреть результат. 

<P class="text2">
<B>Задание 7</B><BR>
Для этого перенесите созданный вами ВМА-файл и 
<A href="files\pauk.jpg" class="wt">текстуру</A> 
для него в директорию, где храниться исполняемый файл проекта, созданного в прошлой лабораторной работе. Измените соответственно
код проекта и заново откомпилируйте его. После этого запустите исполняемый файл и проверте правильность и, вообще, 
успешность создания ВМА-файла.<BR><BR>
</P>

<P class="title2">Вопросы для  самоконтроля</P>
<P class="text">
1)	Что такое BMA-файл?
<BR>2)	Структура BMA-файл?
<BR>3)	Каким образом из Х файла можно выбрать нужный меш и транспортировать его в программу XToBMA?
<BR>4)	Перечислите все шаги создания BMA-файла?
</P>



<!--текст окошка к-->
	<P align="right"><A href="#begin" class="wt">наверх</A></P><BR>
	</TD>
	<TD width="5" height="44" valign="bottom"><IMG src="image/8.gif" width="5" height="44" border="0"></TD>
</TR>
<TR>
	<TD width="5" height="1"><IMG src="image/r5.gif" width="5" height="1" border="0"></TD>
	<TD width="*" height="1" bgcolor="#CFDDF2"><IMG src="image/r6.gif" width="1" height="1" border="0"></TD>
	<TD width="5" height="1"><IMG src="image/r5.gif" width="5" height="1" border="0"></TD>
</TR>
</TABLE>
</DIV>
<P class="mini">MR, Кузнецов Алексей КТ-503, РГППУ, 2007г.</P>
<!--содержание к-->
		</TD>
	</TR>
	</TABLE>
	<!--часть содержания к-->
	</TD>
</TR>
<TR>
</TR>
</TABLE>
</BODY>
</HTML>