<HTML>
<HEAD>
<TITLE>Анимация</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<LINK rel="stylesheet" href="css\style.css" type="text/css">
<SCRIPT src="script/buttonscript.js" language="JavaScript"></SCRIPT>
</HEAD>
<BODY>
<A name="begin"></A>
<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
<TR>
	<TD colspan="2">
	<!--часть шапка н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
	<TR>
		<TD rowspan="2" bgcolor="#3B3B3B">
        	<P class="mainhead">
<!--Основной заголовок н-->
Программирование и внедрение нейросетей
<!--Основной заголовок к-->
			</P>
		</TD>
		<TD bgcolor="#3B3B3B" align="right" valign="top">
		<P class="t2">
<!--в шапке справа вверху н-->
<A href="search.htm" class="help"><IMG src="image/search_b.gif" width="16" height="16" border="0"> Поиск&nbsp;&nbsp;</A>
<A href="help.htm" class="help"><IMG src="image/question_b.gif" width="16" height="16" border="0"> Справка&nbsp;&nbsp;</A>

<!--в шапке справа вверху к-->
		</P>
		</TD>
	</TR>
	<TR>
		<TD bgcolor="#3B3B3B">
			<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
			<TR>
				<TD width="166" height="38"><IMG src="image/1.gif" width="166" height="38" border="0"></TD>
				<TD width="100%" height="38" background="image/2.gif"><IMG src="image/2.gif" width="1" height="38" border="0"></TD>
				<TD width="157" height="38"><IMG src="image/3.gif" width="157" height="38" border="0"></TD>
				<TD bgcolor="#6A6A6A">
					<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
					<TR>
						<TD width="100%" height="100%">
<!--в шапке маленькая надпись с права внизу н-->
<P class="t1">РГППУ</P>
<!--в шапке маленькая надпись с права внизу к-->
						<TD>
					</TR>
					<TR><TD width="100%" height="1" bgcolor="#3B3B3B"><IMG src="image/r1.gif" width="1" height="1" border="0"><TD></TR>
					</TABLE>
				</TD>
			</TR>
			</TABLE>
		</TD>
	</TR>
	<TR>
		<TD colspan="2" bgcolor="#626262"><IMG src="image/r2.gif" width="1" height="16" border="0"></TD>
	<TR>
	</TABLE>
	<!--часть шапка к-->
	</TD>
</TR>
<TR>
	<TD width="*" height="100%" bgcolor="#DFEDF6">
	<!--часть навигация н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">

	<TR>
		<TD width="181" height="30"><IMG src="image/r3.gif" width="1" height="30" border="0"></TD>
		<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
	</TR>
<!--кнопки н-->
<!--
<TR>
	<TD width="181" height="30" background="image\b.gif" align="right" valign="middle">
	<P class="button_on"><NOBR>Начало</NOBR></P>
	</TD>
	<TD width="1" height="30" bgcolor="#FFFFFF"><IMG src="image/r5.gif" width="1" height="1" border="0"></TD>
</TR>
-->

<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="start.htm"><NOBR>Начало</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="create_proj.htm"><NOBR>Создание окна</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="cr_neronet.htm"><NOBR>Создание нейросети</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="initd3d.htm"><NOBR>Запуск Direct3D</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="crdelmod.htm"><NOBR>Визуализация</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" background="image\b.gif" align="right" valign="middle">
	<P class="button_on"><NOBR>Анимация</NOBR></P>
	</TD>
	<TD width="1" height="30" bgcolor="#FFFFFF"><IMG src="image/r5.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="kamera.htm">Камера</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="bma.htm">ВМА-файл</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="frommaxtox.htm">Экспорт модели</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="impl_neronet.htm">Внедрение нейросети</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle">
	<P class="button_on">&nbsp;</P>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="use_books.htm">Литература</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="ip.htm">Интерфейс пособия</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="metodukaz.htm">Методические указания</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="search.htm">Поиск по пособию</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>

<!--кнопки к-->
	<TR>
		<TD width="181" height="100%"><IMG src="image/r3.gif" width="1" height="1" border="0"></TD>
		<TD width="1" height="100%"  bgcolor="#DFEDF6" valign="top"><IMG src="image/9.gif" width="1" height="161" border="0"></TD>
	</TR>
	<TR>
		<TD width="182" height="1"><IMG src="image/r3.gif" width="182" height="1" border="0"></TD>
	</TR>
	</TABLE>
	<!--часть навигация к-->
	</TD>
	<TD width="100%" height="100%">
	<!--часть содержания н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
	<TR>
		<TD align="justify" valign="top">
<!--содержание н-->

<TABLE cellspacing="5" cellpadding="0" border="0" width="*" height="*" align="center" style="margin-top:10px;">
	<TR>
		<TD><A href="anim.htm" class="wt">Анимация</A></TD>
		<TD><A href="morphing.htm" class="wt">Морфинг</A></TD>
		<TD><A href="cunit.htm" class="wt">Класс CUNIT</A></TD>
	</TR>
</TABLE>

<DIV class="layer_window">
<TABLE cellspacing="0" cellpadding="0" border="0" width="*" height="*" align="center" >
<TR>
	<TD width="5" height="23"><IMG src="image/5.gif" width="5" height="23" border="0"></TD>
	<TD width="*" height="23" background="image/4.gif">
		<TABLE cellspacing="0" cellpadding="0" border="0" width="*" height="*" align="center" >
		<TR>
			<TD width="100%" height="23" align="justify" valign="middle" >
<P class="head_window">Анимация</P>
			</TD>
			<TD width="63" height="23"><IMG src="image/mini_b.gif" width="63" height="23" border="0"></TD>
		</TR>
		</TABLE>
	</TD>
	<TD width="5" height="23"><IMG src="image/6.gif" width="5" height="23" border="0"></TD>
<TR>
<TR>
	<TD width="5" height="44" valign="bottom"><IMG src="image/7.gif" width="5" height="44" border="0"></TD>
	<TD height="100%" align="justify" valign="top">
<!--текст окошка н-->



<P class="title">Лабораторная работа №5</P>
<P class="title3">АНИМАЦИЯ МОРФИНГА</P>

<P class="title2">В этой лабораторной работе вы научитесь:</P>
<P class="text">
1) Методике анимирования 3-х мерных мешей (моделей).
<BR>2) Основам морфинга.
<BR>3) Работе с классом CUNIT.
<BR>4) Загрузке и проигрыванию BMA-файлов, содержащих анимированную модель, разработанную в трехмерном редакторе.
<BR>5) А так же научитесь использовать различные вспомогательные методы класса CUNIT.

<P class="title2">1. Анимация по средствам класса CUNIT</P>
<P class="text">Данная глава посвящена методике анимирования 3-х мерных мешей (моделей).
<P class="text">Существует множество различных видов анимации (костная, морфинг, текстурная, 
анимирование системы частиц, анимирование ткани и т.п.), но мы в данной главе будем изучать 
морфинг. «Почему?» - спросите вы… Морфинг наиболее прост в понимании, в программировании и 
обработке – это его огромные плюсы. 
<P class="text"><B>Морфинг – это процесс изменения одной формы на другую.</B> К примеру, имеете два 
меша: исходный и целевой. И если вы примените к данным мешам морфинг, то вершины исходного меша 
будут двигаться к вершинам целевого.<BR>
Обратите внимание на рисунок 1 приведенный ниже, в котором звезда (исходный мешь) в течение 
определенного промежутка времени изменяет свою форму и превращается во что-то похожее на круг (целевой меш):
<CENTER><IMG src="image\examp\5.jpg" class="bo"></CENTER>
<CENTER><P class="ris">Рис. 1</P></CENTER>
<P class="text">Морфинг лег в основу класса CUNIT. В отличие от класса CENVIRONMENT, класс 
CUNIT обрабатывается чуть дольше, но имеет несколько большую функциональность. В классе
CUNIT применен целый комплекс технологий для загрузки и воспроизведения качественной морфирующей анимации.

<P class="text">
Перейдем к реализации морфинга программно.<BR>
Как уже писалось выше, чтобы работать с морфирующей анимацией вы должны 
использовать класс CUNIT. 

<P class="text2">
<B>Задание 1</B><BR>
Откройте свой проект, в котором вы реализовывали визуализацию статической модели по 
средствам класса CENVIRONMENT и перейдите в документ D3DApplication.cpp если он закрыт.

<P class="text">
Методика загрузки анимированной модели в классе CUNIT полностью идентична методике класса CENVIRONMENT. 
За исключением лишь того, что надписи "CENVIRONMENT" вы должны заменить на надписи "CUNIT". 

<P class="text2">
<B>Задание 2</B><BR>
Замените надписи "CENVIRONMENT" на надписи "CUNIT" в только что открытом проекте.

<P class="text2">
<B>Задание 3</B><BR>
Кроме этого ещё нужно заменить внешний BMA файл, т.к. в нем не содержится анимации, а только одна 
статическая модель. Сделайте это взяв BMA-файл с анимацией бегущего паука
<A href="files\pauk_run.zip" class="wt">здесь</A>
.

<P class="text2">
<B>Задание 4</B><BR>
В методе CreateModelFF замените адрес внешнего BMA файла на "pauk_run.bma". В результате у вас получиться так:
</P>
<P class="kod">
HRESULT hRet = Model3D->CreateModelFF("pauk_run.bma", D3DDevice);
</P>

<P class="text">
Чтобы воспроизвести анимацию нужно воспользоваться методом Play() класса CUNIT. Вот его прототип:
<P class="kod">
HRESULT Play();
</P>
<P class="text">
Метод Play(), как видите, не имеет никаких передаваемых параметров, но в свою очередь он возвращает 
значение перечисляемого типа, по которому можно судить о том были ли перезаписаны вершинные буфера вычисленным мешем, 
в результате выполнения метода, или нет.<BR>
Метод Play() проигрывает анимацию - это его главная задача. По умолчанию установлена нулевая анимация (т.е. первая, 
так как в С++ исчисления начинаются с 0). Каждый последующий кадр будет создаваться при очередном вызове метода, 
т.е. данный метод нужно вызывать в цикле. В вашем случае, метод Play() должен размещаться в функции Rendering, т.к. она 
вызывается с некоторой периодичностью. <BR>
Метод Play() должен быть помещен обязательно до метода Present! 
Так требуется потому, что метод Play() вычисляет меш на основе скаляра и перезаписывает вершинные буфера, из которых
в методе Present данные передаются на видеокарту.

<P class="text2">
<B>Задание 5</B><BR>
Более подробно о классе CUNIT написано далее, а пока впишите в функцию Rendering, перед методом Clear 
(очистка экрана) объекта устройства воспроизведения, такую строчку: 
<P class="kod">
Model3D->Play();
</P>

<P class="text">
И ЭТО ВСЕ! 

<P class="text2">
<B>Задание 6</B><BR>
Откомпилируйте проект и запустите исполняемый файл. Если что-то не работает, то проверте все 
ли вы сделали так, как я описывал. Если все равно не работает, можете взять готовый проект 
<A href="files\dinamik_model_3d.zip" class="wt">тут</A>
 и найти свою ошибку.

<P class="text">
Так же хочется акцентировать ваше внимание на последовательности вызовов основных методов класса CUNIT:
<BR> - Создание экземпляра класса CUNIT;
<BR> - Загрузка модели (CreateModelFF);
<BR> - Создание очередного кадра (Play)
<BR> - Передача информации на видеокарту (Present)
<BR> - Удаление объектов класса CUNIT (Release).
<BR>
Первый и последний методы (создание и удаление) вызываются за пределами функции рендеринга, а второй, третий 
и четвертый внутри функции рендеринга.
</P>

<P class="title2">Вопросы для  самоконтроля</P>
<P class="text">
1)	Что такое морфинг?
<BR>2)	Чем отличаются классы CUNIT и CENVIRONMENT?
<BR>3)	Для чего нужен метод Play() класса CUNIT?
<BR>4)	Какие данные возвращает метод Play() и зачем они нужны?
<BR>5)	Как по отношению к методу Present() класса CUNIT должен быть расположен метод Play()?
</P>

<P align="center">
<A href="morphing.htm" class="wt">далее</A>
</P>



<!--текст окошка к-->
	<P align="right"><A href="#begin" class="wt">наверх</A></P><BR>
	</TD>
	<TD width="5" height="44" valign="bottom"><IMG src="image/8.gif" width="5" height="44" border="0"></TD>
</TR>
<TR>
	<TD width="5" height="1"><IMG src="image/r5.gif" width="5" height="1" border="0"></TD>
	<TD width="*" height="1" bgcolor="#CFDDF2"><IMG src="image/r6.gif" width="1" height="1" border="0"></TD>
	<TD width="5" height="1"><IMG src="image/r5.gif" width="5" height="1" border="0"></TD>
</TR>
</TABLE>
</DIV>
<P class="mini">MR, Кузнецов Алексей КТ-503, РГППУ, 2007г.</P>
<!--содержание к-->
		</TD>
	</TR>
	</TABLE>
	<!--часть содержания к-->
	</TD>
</TR>
<TR>
</TR>
</TABLE>
</BODY>
</HTML>