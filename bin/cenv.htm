<HTML>
<HEAD>
<TITLE>CENVIRONMENT</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<LINK rel="stylesheet" href="css\style.css" type="text/css">
<SCRIPT src="script/buttonscript.js" language="JavaScript"></SCRIPT>
</HEAD>
<BODY>
<A name="begin"></A>
<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
<TR>
	<TD colspan="2">
	<!--часть шапка н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
	<TR>
		<TD rowspan="2" bgcolor="#3B3B3B">
        	<P class="mainhead">
<!--Основной заголовок н-->
Программирование и внедрение нейросетей
<!--Основной заголовок к-->
			</P>
		</TD>
		<TD bgcolor="#3B3B3B" align="right" valign="top">
		<P class="t2">
<!--в шапке справа вверху н-->
<A href="search.htm" class="help"><IMG src="image/search_b.gif" width="16" height="16" border="0"> Поиск&nbsp;&nbsp;</A>
<A href="help.htm" class="help"><IMG src="image/question_b.gif" width="16" height="16" border="0"> Справка&nbsp;&nbsp;</A>

<!--в шапке справа вверху к-->
		</P>
		</TD>
	</TR>
	<TR>
		<TD bgcolor="#3B3B3B">
			<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
			<TR>
				<TD width="166" height="38"><IMG src="image/1.gif" width="166" height="38" border="0"></TD>
				<TD width="100%" height="38" background="image/2.gif"><IMG src="image/2.gif" width="1" height="38" border="0"></TD>
				<TD width="157" height="38"><IMG src="image/3.gif" width="157" height="38" border="0"></TD>
				<TD bgcolor="#6A6A6A">
					<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
					<TR>
						<TD width="100%" height="100%">
<!--в шапке маленькая надпись с права внизу н-->
<P class="t1">РГППУ</P>
<!--в шапке маленькая надпись с права внизу к-->
						<TD>
					</TR>
					<TR><TD width="100%" height="1" bgcolor="#3B3B3B"><IMG src="image/r1.gif" width="1" height="1" border="0"><TD></TR>
					</TABLE>
				</TD>
			</TR>
			</TABLE>
		</TD>
	</TR>
	<TR>
		<TD colspan="2" bgcolor="#626262"><IMG src="image/r2.gif" width="1" height="16" border="0"></TD>
	<TR>
	</TABLE>
	<!--часть шапка к-->
	</TD>
</TR>
<TR>
	<TD width="*" height="100%" bgcolor="#DFEDF6">
	<!--часть навигация н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">

	<TR>
		<TD width="181" height="30"><IMG src="image/r3.gif" width="1" height="30" border="0"></TD>
		<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
	</TR>
<!--кнопки н-->
<!--
<TR>
	<TD width="181" height="30" background="image\b.gif" align="right" valign="middle">
	<P class="button_on"><NOBR>Начало</NOBR></P>
	</TD>
	<TD width="1" height="30" bgcolor="#FFFFFF"><IMG src="image/r5.gif" width="1" height="1" border="0"></TD>
</TR>
-->

<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="start.htm"><NOBR>Начало</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="create_proj.htm"><NOBR>Создание окна</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="cr_neronet.htm"><NOBR>Создание нейросети</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="initd3d.htm"><NOBR>Запуск Direct3D</NOBR></A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" background="image\b.gif" align="right" valign="middle">
	<P class="button_on"><NOBR>Визуализация</NOBR></P>
	</TD>
	<TD width="1" height="30" bgcolor="#FFFFFF"><IMG src="image/r5.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="anim.htm">Анимация</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="kamera.htm">Камера</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="bma.htm">ВМА-файл</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="frommaxtox.htm">Экспорт модели</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="impl_neronet.htm">Внедрение нейросети</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle">
	<P class="button_on">&nbsp;</P>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="use_books.htm">Литература</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="ip.htm">Интерфейс пособия</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="metodukaz.htm">Методические указания</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>
<TR>
	<TD width="181" height="30" align="right" valign="middle" onmouseover="bgimageon(this)" onmouseout="bgimageof(this)">
	<A href="search.htm">Поиск по пособию</A>
	</TD>
	<TD width="1" height="30" bgcolor="#90B2D9"><IMG src="image/r4.gif" width="1" height="1" border="0"></TD>
</TR>

<!--кнопки к-->
	<TR>
		<TD width="181" height="100%"><IMG src="image/r3.gif" width="1" height="1" border="0"></TD>
		<TD width="1" height="100%"  bgcolor="#DFEDF6" valign="top"><IMG src="image/9.gif" width="1" height="161" border="0"></TD>
	</TR>
	<TR>
		<TD width="182" height="1"><IMG src="image/r3.gif" width="182" height="1" border="0"></TD>
	</TR>
	</TABLE>
	<!--часть навигация к-->
	</TD>
	<TD width="100%" height="100%">
	<!--часть содержания н-->
	<TABLE cellspacing="0" cellpadding="0" border="0" width="100%" height="100%" align="center">
	<TR>
		<TD align="justify" valign="top">
<!--содержание н-->

<TABLE cellspacing="5" cellpadding="0" border="0" width="*" height="*" align="center" style="margin-top:10px;">
	<TR>
		<TD><A href="crdelmod.htm" class="wt">Загрузка модели</A></TD>
		<TD><A href="presentstaticmod.htm" class="wt">Презентация модели</A></TD>
		<TD><A href="cenv.htm" class="wt">CENVIRONMENT</A></TD>

	</TR>
</TABLE>



<DIV class="layer_window">
<TABLE cellspacing="0" cellpadding="0" border="0" width="*" height="*" align="center" >
<TR>
	<TD width="5" height="23"><IMG src="image/5.gif" width="5" height="23" border="0"></TD>
	<TD width="*" height="23" background="image/4.gif">
		<TABLE cellspacing="0" cellpadding="0" border="0" width="*" height="*" align="center" >
		<TR>
			<TD width="100%" height="23" align="justify" valign="middle" >
<P class="head_window">Визуализация</P>
			</TD>
			<TD width="63" height="23"><IMG src="image/mini_b.gif" width="63" height="23" border="0"></TD>
		</TR>
		</TABLE>
	</TD>
	<TD width="5" height="23"><IMG src="image/6.gif" width="5" height="23" border="0"></TD>
<TR>
<TR>
	<TD width="5" height="44" valign="bottom"><IMG src="image/7.gif" width="5" height="44" border="0"></TD>
	<TD height="100%" align="justify" valign="top">
<!--текст окошка н-->



<P class="title2">3. Класс CENVIRONMENT</P>
<P class="text">
Описание класса располагается в файле заголовков CEnvironment.h, реализация в CEnvironment.cpp . 
Рассмотрим данный класс подробнее:
</P>
<P class="kod">
class CENVIRONMENT<BR>
{<BR>
	&nbsp;&nbsp;public:<BR>
	&nbsp;&nbsp;CMODEL Mesh; //хранилище меша<BR>
	&nbsp;&nbsp;LPDIRECT3DTEXTURE9 Texture1;<BR>
	&nbsp;&nbsp;LPDIRECT3DDEVICE9 D3DDevice;<BR>
	&nbsp;&nbsp;LPDIRECT3DVERTEXBUFFER9 BufferVershin;<BR>
	&nbsp;&nbsp;float scale; //размер модели<BR>
	&nbsp;&nbsp;_RRFLAG rrlight; //вкл. \ откл. обработку света<BR>
	&nbsp;&nbsp;CUSTOMVERTEX Place; //место расположения<BR>
	&nbsp;&nbsp;//углы поворота<BR>
	&nbsp;&nbsp;float angx;<BR>
	&nbsp;&nbsp;float angy;<BR>
	&nbsp;&nbsp;float angz;<BR><BR>

	&nbsp;&nbsp;public:<BR>
	&nbsp;&nbsp;CENVIRONMENT();<BR>
	&nbsp;&nbsp;CENVIRONMENT(float _scale, _RRFLAG _rrlight, CUSTOMVERTEX* place);<BR>
	&nbsp;&nbsp;//отображение загруженной модели по ссылке D3DDevice<BR> 
	&nbsp;&nbsp;HRESULT Present();<BR>
	&nbsp;&nbsp;//перезапись вершинного буфера<BR>
	&nbsp;&nbsp;HRESULT ReBuf();<BR>
	&nbsp;&nbsp;//удаление D3DDevice, BufferVershin, Texture1<BR> 
	&nbsp;&nbsp;void Release();<BR><BR>
        
	&nbsp;&nbsp;//Загрузка модели и текстуры из внешнего BMA файла<BR>
	&nbsp;&nbsp;HRESULT CreateModelFF(char* passfile, LPDIRECT3DDEVICE9 Device);<BR>
};
</P>
<P class="text">
где:
<BR>1) &nbsp;&nbsp;CMODEL Mesh; - Хранилище меша. Тип CMODEL описан в файлах CModel.h и CModel.cpp .
<BR>2) &nbsp;&nbsp;LPDIRECT3DTEXTURE9 Texture1; - Буфер текстуры.
<BR>3) &nbsp;&nbsp;LPDIRECT3DDEVICE9 D3DDevice; - Ссылка на объект устройства.
<BR>4)&nbsp;&nbsp; LPDIRECT3DVERTEXBUFFER9 BufferVershin; - Буфер вершин.
<BR>5) _RRFLAG rrlight; - перечисляемый тип (Флаг режима работы), описанный в файле Types.cpp . В данном случае 
используется только 2 значения: RR_LIGHTON - вкл. обработку света для данной модели, RR_LIGHTOFF - 
выкл. обработку света для данной модели. 
<BR>6) &nbsp;&nbsp;CUSTOMVERTEX Place; - место расположения модели относительно мировой системы координат 
(локальная система координат). Тип CUSTOMVERTEX описан в  файлах CVertex.h и CVertex.cpp.
В данном значении этого типа используются только 3 поля x, y, z. Поля nx, ny, nz, tu, tv - не используются
(можете их использовать в своих целях).
<BR>7) &nbsp;&nbsp;angx, angy, angz углы поворота модели (локальной системы координат).
<BR>8) &nbsp;&nbsp;HRESULT Present(); - метод, с помощью которого можно отобразить модель по ссылке D3DDevice. При изменении
полей отвечающих за локальную систему координат, данные изменения вступают в силу только после применения 
данного метода (Present).
<BR>9) &nbsp;&nbsp;HRESULT ReBuf(); - метод, отвечающий за перезапись вершинного буфера. Данный метод используется, к примеру,
в том случае, когда хранилище меша (Mesh) был заполнен не с помощью функции CreateModelFF, а каким-нибудь 
иным способом. Но следует помнить, что буфер вершин должен быть создан и указатель на него должен быть размещен 
в BufferVershin.
<BR>10) &nbsp;&nbsp;void Release(); - метод, уничтожает буфера Texture1, BufferVershin.
<BR>11) &nbsp;&nbsp;HRESULT CreateModelFF(char* passfile, LPDIRECT3DDEVICE9 Device); - загрузка модели и текстуры из внешних
файлов (модель = *.BMA, текстура = любой граф. формат) в хранилище меша (Mesh) и одновременное создание и запись 
буфера вершин и текстурного буфера.<BR><BR> 
</P>

<P class="text2">
<B>Задание 12</B><BR>
Организуйте поворот модели вокруг оси Z. Для этого напишите ниже 
приведенный код после проверки наличия ссылки на объект видеокарты в функции Rendering():  
</P>
<P class="kod">
if (Model3D->angz<=359) {Model3D->angz+=1;}<BR> 
	&nbsp;&nbsp;else {Model3D->angz = 0;};
</P>
<P class="text">
Данный код описывает изменение угла модели. Если угол меньше либо равен 359, то угол поворота модели 
увеличивается на 1 градус, иначе равен 0.

<P class="text2">
<B>Задание 13</B><BR>
Откомпилируйте проект. Модель должна поворачиваться вокруг оси Z.
Если возникли проблемы, то возьмите готовый проект
<A href="files\static_model_3d_return.zip" class="wt">здесь</A>
 и найдите свою ошибку.

<P class="text2">
<B>Задание 14</B><BR>
Сохраните свою работу. И пригласите преподавателя.

<P class="title2">Вопросы для  самоконтроля</P>
<P class="text">
1)	В каком атрибуте класса CENVIRONMENT храниться информация о вершинах модели?
<BR>2)	Какой атрибут класса CENVIRONMENT отвечает за местоположение модели относительно мировой системы координат?
<BR>3)	Какие атрибуты класса CENVIRONMENT отвечают за углы поворота модели?
<BR>4)	Какой метод позволяет загрузить модель из внешнего файла?
<BR>5)	Какой метод позволяет презентовать модель на сцене?
</P>

<P align="center">
<A href="presentstaticmod.htm" class="wt">назад</A>
</P>



<!--текст окошка к-->
	<P align="right"><A href="#begin" class="wt">наверх</A></P><BR>
	</TD>
	<TD width="5" height="44" valign="bottom"><IMG src="image/8.gif" width="5" height="44" border="0"></TD>
</TR>
<TR>
	<TD width="5" height="1"><IMG src="image/r5.gif" width="5" height="1" border="0"></TD>
	<TD width="*" height="1" bgcolor="#CFDDF2"><IMG src="image/r6.gif" width="1" height="1" border="0"></TD>
	<TD width="5" height="1"><IMG src="image/r5.gif" width="5" height="1" border="0"></TD>
</TR>
</TABLE>
</DIV>
<P class="mini">MR, Кузнецов Алексей КТ-503, РГППУ, 2007г.</P>
<!--содержание к-->
		</TD>
	</TR>
	</TABLE>
	<!--часть содержания к-->
	</TD>
</TR>
<TR>
</TR>
</TABLE>
</BODY>
</HTML>